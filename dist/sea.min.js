String.prototype.uncapitalize=function(){return this.charAt(0).toLowerCase()+this.slice(1)};var SeaORM=function(a){"use strict";var b={},c=function(a,b){Object.defineProperty(a,b,{get:function(){return a.get(b)},set:function(c){a.set(b,c)},enumerable:!0,configurable:!1})},d=function(){var b={},d=1,f=function(e,f,g){var h=this;Object.defineProperty(h,"_id",{value:d++,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(h,"_resource",{value:f,writable:!1,enumerable:!1,configurable:!1}),b[this._id]={fields:a.extend({id:0},e.fields),resourceObject:null},Object.defineProperty(h,"isNew",{get:function(){return 0==b[h._id].fields.id},enumerable:!1,configurable:!1}),Object.defineProperty(h,"isLoaded",{get:function(){return 0!=b[h._id].fields.id&&null!==b[h._id].resourceObject},enumerable:!1,configurable:!1}),"object"==typeof g?h.setFields(g):"number"==typeof g&&parseInt(g,10)&&h.set("id",parseInt(g,10));for(var i in b[this._id].fields){for(;"function"==typeof b[this._id].fields[i];)b[this._id].fields[i]=b[this._id].fields[i](this),"object"==typeof g&&g[i]&&h.set(i,g[i]);c(this,i)}};return f.prototype.toJS=function(){var a={};for(var c in b[this._id].fields)null!=b[this._id].fields[c]&&b[this._id].fields[c]instanceof e?a[c]=b[this._id].fields[c].toJS():a[c]=b[this._id].fields[c];return a},f.prototype.toJSON=function(){return JSON.stringify(this.toJS())},f.prototype.get=function(c,d,f){return"string"==typeof c&&c in b[this._id].fields?null!=b[this._id].fields[c]&&b[this._id].fields[c]instanceof e?b[this._id].fields[c].get(d,f):b[this._id].fields[c]:a.copy(b[this._id].fields)},f.prototype.set=function(a,c){"string"==typeof a&&a in b[this._id].fields?null!=b[this._id].fields[a]&&b[this._id].fields[a]instanceof e?(b[this._id].fields[a].set(c),this.isLoaded&&(b[this._id].resourceObject[a]=b[this._id].fields[a].toJS())):"function"!=typeof b[this._id].fields[a]&&(b[this._id].fields[a]=c,this.isLoaded&&(b[this._id].resourceObject[a]=c)):"object"==typeof a&&this.setFields(a)},f.prototype.setFields=function(a){if("object"==typeof a)for(var b in a)this.set(b,a[b])},f.prototype.load=function(a,c){var d=this;b[this._id].resourceObject=this._resource.get({id:this.id},function(b,c){d.set(b),"function"==typeof a&&a(d,c)},function(a){"function"==typeof c&&c(a)})},f.prototype.save=function(a,c){var d=this;if(!this.isLoaded){var e=this.toJS();this.isNew&&delete e.id,b[this._id].resourceObject=new this._resource(e)}var f=function(c,e){d.set(b[d._id].resourceObject),"function"==typeof a&&a(d,e)},g=function(a){"function"==typeof c&&c(a)};return this.isNew?b[this._id].resourceObject.$create(f,g):b[this._id].resourceObject.$update(f,g),d},f.prototype.remove=function(a,c){var d=this;this.isNew||(this.isLoaded||(b[this._id].resourceObject=new this._resource(this.toJS())),b[this._id].resourceObject.$remove(function(b,c){"function"==typeof a&&a(d,c)},function(a){"function"==typeof c&&c(a)}))},f}(),e=function(){var a=function(a,b){this.object=null,this.model=a,this.instance=b};return a.prototype.get=function(a,b){},a.prototype.set=function(a){},a.prototype.toJS=function(){},a}(),f=function(){var a=function(a,b){e.call(this,a,b)};return a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.prototype.toJS=function(){return e.prototype.toJS.call(this),this.object?this.object.id:null},a.prototype.get=function(a,b){return e.prototype.get.call(this,a,b),!this.object||this.object.isNew||this.object.isLoaded?"function"==typeof a&&a(this.object):this.object.load(a,b),this.object},a.prototype.set=function(a){e.prototype.set.call(this,a),null!=a&&"number"==typeof a?(a=parseInt(a,10),isNaN(a)||null!=this.object&&this.object.id==a||(this.object=new this.model({id:a}))):(null==a||a instanceof this.model)&&(this.object=a)},a}(),g=function(){var a=function(a,b,c){e.call(this,a,b),this.related_field=c,this.isLoaded=!1,this.loading_success_cb=[],this.loading_error_cb=[]};return a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.prototype.execute_success_cb=function(a,b){for(var c=0;c<this.loading_success_cb.length;c++)this.loading_success_cb[c](a,b);this.loading_success_cb=[],this.loading_error_cb=[]},a.prototype.execute_error_cb=function(a){for(var b=0;b<this.loading_error_cb.length;b++)this.loading_error_cb[b](a);this.loading_success_cb=[],this.loading_error_cb=[]},a.prototype.register_callbacks=function(a,b){"function"==typeof a&&this.loading_success_cb.push(a),"function"==typeof b&&this.loading_error_cb.push(b)},a.prototype.toJS=function(){if(e.prototype.toJS.call(this),!this.object)return null;for(var a=[],b=0;b<this.object.length;b++)a.push(this.object[b].id);return a},a.prototype.has_object=function(a){if(!this.object)return!1;for(var b=0;b<this.object.length;b++)if(this.object[b].id==a)return!0;return!1},a.prototype.get=function(a,b){e.prototype.get.call(this,a,b);var c=this;if(!c.object){var d={};d[c.related_field]=c.instance.id,c.object=c.model.query(d,function(a,b){c.isLoaded=!0,c.execute_success_cb(a,b)},function(a){c.execute_error_cb(a)})}return c.register_callbacks(a,b),c.isLoaded&&c.execute_success_cb(c.object),c.object},a.prototype.set=function(a){if(e.prototype.set.call(this,a),"number"==typeof a)a=parseInt(a,10),this.object||(this.object=[],this.isLoaded=!0),this.has_object(a)||this.object.push(new this.model({id:a}));else if(a instanceof this.model)this.object||(this.object=[],this.isLoaded=!0),this.has_object(a.id)||this.object.push(a);else if(a instanceof Array){var b=[],c={};this.object=b;for(var d=0;d<a.length;d++)a[d]instanceof this.model&&!c[a[d].id]&&(b.push(a[d]),c[a[d].id]=!0);this.isLoaded=!0}else null===a&&(this.object=null,this.isLoaded=!1)},a}(),h=function(c,e){var h=this,i={endpointPrefix:"",endpoint:function(a){return"/"+a.uncapitalize()+"/:id/"},methods:{get:{method:"GET"},create:{method:"POST"},update:{method:"PUT"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},delete:{method:"DELETE"}}};this.config=function(b){return"object"!=typeof b?i:(a.extend(i,b),h)},this.prefixedEndpoint=function(a,b){if("object"!=typeof a)throw"config should be an object";if("object"!=typeof b)throw"declaration should be an object";var c=a.endpointPrefix||"",d=b.endpoint||"";return d||("function"==typeof a.endpoint?d=a.endpoint(b.name):"string"==typeof a.endpoint&&(d=a.endpoint)),c+d},this.newModel=function(e,f){if("object"!=typeof e)throw"declaration should be an object";if("string"!=typeof e.name)throw"declaration should define a string name attribute";"object"!=typeof f&&(f={}),f=a.extend({},i,f);var g=h.prefixedEndpoint(f,e),j=c(g,{id:"@id"},f.methods),k=function(){var a=Array.prototype.slice.call(arguments);a.unshift(e,j),d.apply(this,a)};k.prototype=Object.create(d.prototype),k.prototype.constructor=k,Object.defineProperty(k.prototype,"_endpoint",{value:g,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(k.prototype,"_modelName",{value:e.name,writable:!1,enumerable:!1,configurable:!1});for(var l in e.methods)"function"==typeof e.methods[l]&&(k.prototype[l]=e.methods[l]);return k.query=function(a,b,c){"function"==typeof a&&(c=b,b=a,a={});var d=[],e=null,f=j.query(a,function(a,c){for(var g=0;g<f.length;g++)e=new k(f[g]),d.push(e);"function"==typeof b&&b(d,c)},function(a){"function"==typeof c&&c(a)});return d},k.get=function(a,b,c){if(!a)throw"id argument is required";var d=new k({id:a});return d.load(b,c),d},b[e.name]=k,k},this.belongsTo=function(a){if(void 0===a||null===a||!(a.prototype instanceof d)&&"string"!=typeof a)throw"Invalid model parameter. It should be a string or Sea Model!";return function(c){return"string"==typeof a?new f(b[a],c):new f(a,c)}},this.hasMany=function(a,c){if(void 0===a||null===a||!(a.prototype instanceof d)&&"string"!=typeof a)throw"Invalid model parameter. It should be a string or Sea Model!";if("string"!=typeof c)throw"Invalid related_field parameter. It should be a string!";return function(d){return"string"==typeof a?new g(b[a],d,c):new g(a,d,c)}},this.config(e)};return a.module("seaModel",["ngResource"]).provider("$seaModel",function(){var b={};this.config=function(c){a.extend(b,c)},this.$get=["$resource",function(a){return new h(a,b)}]}),h}(angular);
//# sourceMappingURL=sea.min.js.map